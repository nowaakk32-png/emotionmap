<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="stylesheet" href="css/styles.css" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />
    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""
    ></script>
    <title>emptionmap - —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞ –≥–æ—Ä–æ–¥–∞</title>
  </head>
  <body>
    <header>
      <span class="logo"
        ><img src="assests/icons/4599477.png" alt="" width="32" height="32" />
        emotionmap</span
      >
      <nav>
        <ul>
          <li><a href="#im">–ì–ª–∞–≤–Ω–∞—è</a></li>
          <li><a href="#help">–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è</a></li>
          <li><a href="#stats-section">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a></li>
          <li><a href="about.html">–û –ø—Ä–æ–µ–∫—Ç–µ</a></li>
        </ul>
      </nav>
    </header>
    <div id="im" class="container">
<!-- Hero —Å–µ–∫—Ü–∏—è -->
<section class="hero">
  <h2>–ö–∞—Ä—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è –≤–∞—à–µ–≥–æ –≥–æ—Ä–æ–¥–∞</h2>
  <h3>–£–∑–Ω–∞–π—Ç–µ, –∫–∞–∫–∏–µ –º–µ—Å—Ç–∞ –≤—ã–∑—ã–≤–∞—é—Ç —Ä–∞–¥–æ—Å—Ç—å, –∞ –≥–¥–µ –ª—é–¥–∏ –≥—Ä—É—Å—Ç—è—Ç</h3>
  <h3>–°—Ç–∞–Ω—å—Ç–µ —á–∞—Å—Ç—å—é –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –≥–æ—Ä–æ–¥—Å–∫–æ–π –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã!</h3>
  
  <a href="/map.html" class="hero-button">üéâ –î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ—é —ç–º–æ—Ü–∏—é</a>
  
  <h4>&#9660; –ª–∏—Å—Ç–∞–π—Ç–µ –≤–Ω–∏–∑ &#9660;</h4>
</section>
      <section class="how-it-works">
        <h2 class="section-title">–¢—Ä–∏ –ø—Ä–æ—Å—Ç—ã—Ö —à–∞–≥–∞ –∫ –≤–∞—à–µ–π —ç–º–æ—Ü–∏–∏ –Ω–∞ –∫–∞—Ä—Ç–µ</h2>
        <div class="steps-container">
          <div class="step-card">
            <span class="step-number">1</span>
            <div class="step-icon">üó∫Ô∏è</div>
            <h3 class="step-title">–ù–∞–π–¥–∏—Ç–µ –º–µ—Å—Ç–æ</h3>
            <p class="step-description">
              –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∫–∞—Ä—Ç–µ —Ç–∞–º, –≥–¥–µ —Ö–æ—Ç–∏—Ç–µ –æ—Å—Ç–∞–≤–∏—Ç—å —ç–º–æ—Ü–∏—é
            </p>
          </div>
          <div id="help" class="step-card">
            <span class="step-number">2</span>
            <div class="step-icon">üòä</div>
            <h3 class="step-title">–í—ã–±–µ—Ä–∏—Ç–µ —ç–º–æ—Ü–∏—é</h3>
            <p class="step-description">
              –û—Ç —Ä–∞–¥–æ—Å—Ç–∏ –¥–æ –≥—Ä—É—Å—Ç–∏ - –æ—Ç–º–µ—Ç—å—Ç–µ –≤–∞—à–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ
            </p>
          </div>
          <div class="step-card">
            <span class="step-number">3</span>
            <div class="step-icon">üìù</div>
            <h3 class="step-title">–û—Å—Ç–∞–≤—å—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</h3>
            <p class="step-description">
              –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ, –ø–æ—á–µ–º—É —ç—Ç–æ –º–µ—Å—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç —Ç–∞–∫–∏–µ —á—É–≤—Å—Ç–≤–∞
            </p>
          </div>
        </div>
      </section>
      <section class="realmap">
        <h1>–ñ–∏–≤–∞—è –∫–∞—Ä—Ç–∞</h1>
      </section>
      <section id="map"></section>
      <section id="stats-section" class="stats-section container">
  <h2 class="section-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ EmotionMap</h2>
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-number" id="total-emotions">0</div>
      <div class="stat-label">–í—Å–µ–≥–æ —ç–º–æ—Ü–∏–π</div>
      <div class="stat-trend trend-up">‚Üë 12% –∑–∞ –Ω–µ–¥–µ–ª—é</div>
    </div>
    <div class="stat-card">
      <div class="stat-number" id="positive-emotions">0</div>
      <div class="stat-label">–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–π</div>
      <div class="stat-trend trend-up">‚Üë 5% –∑–∞ –º–µ—Å—è—Ü</div>
    </div>
    <div class="stat-card">
      <div class="stat-number" id="active-users">0</div>
      <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
      <div class="stat-trend trend-up">‚Üë 8% —Å–µ–≥–æ–¥–Ω—è</div>
    </div>
    <div class="stat-card">
      <div class="stat-number" id="districts">0</div>
      <div class="stat-label">–û—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤</div>
      <div class="stat-trend trend-up">‚Üë 3 –Ω–æ–≤—ã—Ö</div>
    </div>
  </div>
</section>
      <section class="lastem">
        <div class="firstlast"></div>
        <div class="seclast"></div>
        <div class="treelast"></div>
      </section>
      <section class="why-section">
        <h2 class="section-title">EmotionMap ‚Äî —ç—Ç–æ –±–æ–ª—å—à–µ, —á–µ–º –ø—Ä–æ—Å—Ç–æ –∫–∞—Ä—Ç–∞</h2>
        <div class="why-grid">
          <div class="why-card">
            <span class="audience-tag">–î–ª—è –∂–∏—Ç–µ–ª–µ–π</span>
            <div class="why-icon">üè†</div>
            <h3 class="why-title">–û—Ç–∫—Ä–æ–π—Ç–µ –≥–æ—Ä–æ–¥ –∑–∞–Ω–æ–≤–æ</h3>
            <p class="why-description">
              –£–∑–Ω–∞–≤–∞–π—Ç–µ –∞—Ç–º–æ—Å—Ñ–µ—Ä—É —Ä–∞–∑–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤, –Ω–∞—Ö–æ–¥–∏—Ç–µ –º–µ—Å—Ç–∞, –≥–¥–µ –≤–∞–º –±—É–¥–µ—Ç
              –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ, –¥–µ–ª–∏—Ç–µ—Å—å —Å–≤–æ–∏–º–∏ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è–º–∏ —Å —Å–æ–æ–±—â–µ—Å—Ç–≤–æ–º
            </p>
          </div>
          <div class="why-card">
            <span class="audience-tag">–î–ª—è –≥–æ—Ä–æ–¥–∞</span>
            <div class="why-icon">üèôÔ∏è</div>
            <h3 class="why-title">–ü–æ–º–æ–≥–∏—Ç–µ –≥–æ—Ä–æ–¥—É —Å—Ç–∞—Ç—å –ª—É—á—à–µ</h3>
            <p class="why-description">
              –í–∞—à–∏ —ç–º–æ—Ü–∏–∏ –ø–æ–º–æ–≥–∞—é—Ç –ø–æ–Ω—è—Ç—å, –∫–∞–∫–∏–µ –º–µ—Å—Ç–∞ –Ω—É–∂–¥–∞—é—Ç—Å—è –≤ —É–ª—É—á—à–µ–Ω–∏–∏ –∏
              —Å–æ–∑–¥–∞–≤–∞—Ç—å –±–æ–ª–µ–µ –∫–æ–º—Ñ–æ—Ä—Ç–Ω—É—é –≥–æ—Ä–æ–¥—Å–∫—É—é —Å—Ä–µ–¥—É –¥–ª—è –≤—Å–µ—Ö
            </p>
          </div>
          <div class="why-card">
            <span class="audience-tag">–î–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–µ–π</span>
            <div class="why-icon">üî¨</div>
            <h3 class="why-title">–ò–∑—É—á–∞–π—Ç–µ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—é –≥–æ—Ä–æ–¥–∞</h3>
            <p class="why-description">
              –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –¥–∏–Ω–∞–º–∏–∫—É –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–π, –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Å–æ—Ü–∏–∞–ª—å–Ω–æ–µ
              —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ –∏ —É—á–∞—Å—Ç–≤—É–π—Ç–µ –≤ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è—Ö –≥–æ—Ä–æ–¥—Å–∫–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
            </p>
          </div>
        </div>
      </section>
    </div>
    <footer class="modern-footer">
  <div class="footer-container">
    <!-- –ö–æ–ª–æ–Ω–∫–∞ 1: –û –ø—Ä–æ–µ–∫—Ç–µ -->
    <div class="footer-section">
      <h3 class="footer-logo">
        <img src="assests/icons/4599477.png" alt="EmotionMap" width="24" height="24" />
        EmotionMap
      </h3>
      <p class="footer-description">
        –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞ –≥–æ—Ä–æ–¥–∞, —Å–æ–∑–¥–∞–Ω–Ω–∞—è –≤–∞–º–∏. –ò—Å—Å–ª–µ–¥—É–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è, –¥–µ–ª–∏—Ç–µ—Å—å –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è–º–∏ –∏ –ø–æ–º–æ–≥–∞–π—Ç–µ –¥–µ–ª–∞—Ç—å –≥–æ—Ä–æ–¥ –ª—É—á—à–µ.
      </p>
      <div class="social-links">
        <a href="https://vk.com/id791334928" target="_blank" aria-label="VK"><img src="assests/icons/icons8-vk-50.png" alt=""></a>
        <a href="https://t.me/Ilya14032" target="_blank" aria-label="Telegram"><img src="assests/icons/icons8-telegram-50.png" alt=""></a>
        <a href="mailto:nowaakk32@gmail.com" aria-label="Email"><img src="assests/icons/icons8-gmail-50.png" alt=""></a>
      </div>
    </div>

    <!-- –ö–æ–ª–æ–Ω–∫–∞ 2: –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div class="footer-section">
      <h4>–ù–∞–≤–∏–≥–∞—Ü–∏—è</h4>
      <ul class="footer-links">
        <li><a href="/">–ì–ª–∞–≤–Ω–∞—è</a></li>
        <li><a href="/map.html">–ö–∞—Ä—Ç–∞</a></li>
        <li><a href="/about.html">–û –ø—Ä–æ–µ–∫—Ç–µ</a></li>
        <li><a href="#stats-section">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a></li>
      </ul>
    </div>

    <!-- –ö–æ–ª–æ–Ω–∫–∞ 3: –ö–æ–Ω—Ç–∞–∫—Ç—ã -->
    <div class="footer-section">
      <h4>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h4>
      <p>üìç –ö–∞–ª–∞—á, –í–æ—Ä–æ–Ω–µ–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</p>
      <p>üìû +7 939 945 30 93</p>
      <p>‚úâÔ∏è nowaakk32@gmail.com</p>
      <p>üë®‚Äçüíª –ê–≤—Ç–æ—Ä: –ò–ª—å—è –ë–∞–±–∏–Ω</p>
    </div>

    <!-- –ö–æ–ª–æ–Ω–∫–∞ 4: –î–æ–ø. –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
    <div class="footer-section">
      <h4>EmotionMap</h4>
      <ul class="footer-links">
        <li>5000+ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞</li>
        <li>–°–æ–±–∏—Ä–∞–ª–æ—Å—å —Å —Å–µ–Ω—Ç—è–±—Ä—è 2025</li>
        <li>100% —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞</li>
        <li>–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏: html, css, Node.js, Leaflet, SQLite</li>
      </ul>
    </div>
  </div>

  <div class="footer-bottom">
    <p>&copy; 2026 EmotionMap. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
    <p>–°–¥–µ–ª–∞–Ω–æ —Å ‚ù§Ô∏è –≤ –ö–∞–ª–∞—á–µ</p>
  </div>
</footer>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
  const SERVER_URL = window.location.origin;

  function initReadOnlyMap() {
    const map = L.map('map').setView([50.424119, 41.01624], 12);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '¬© OpenStreetMap contributors'
    }).addTo(map);

    // –§—É–Ω–∫—Ü–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ —Å—á—ë—Ç—á–∏–∫–∞
function animateCounter(element, target, duration = 2000) {
  let start = 0;
  const increment = target / (duration / 16); // ~60 FPS

  const timer = setInterval(() => {
    start += increment;
    if (start >= target) {
      element.textContent = target.toLocaleString();
      clearInterval(timer);
    } else {
      element.textContent = Math.ceil(start).toLocaleString();
    }
  }, 16);
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞, –≤–∏–¥–µ–Ω –ª–∏ –±–ª–æ–∫ –≤ –∑–æ–Ω–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏
function isInViewport(element) {
  const rect = element.getBoundingClientRect();
  return rect.top <= window.innerHeight && rect.bottom >= 0;
}

let statsLoaded = false;

function loadStatsIfNeeded() {
  if (statsLoaded || !isInViewport(document.getElementById("stats-section"))) return;

  statsLoaded = true;

  fetch(`${SERVER_URL}/api/stats`)
    .then(res => res.json())
    .then(data => {
      animateCounter(document.getElementById("total-emotions"), data.total);
      animateCounter(document.getElementById("positive-emotions"), data.positive);
      animateCounter(document.getElementById("active-users"), data.users);
      animateCounter(document.getElementById("districts"), data.districts);
    })
    .catch(err => {
      console.error("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:", err);
      // –ï—Å–ª–∏ API –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç ‚Äî –ø–æ–∫–∞–∂–µ–º "–∑–∞–≥–ª—É—à–∫–∏"
      animateCounter(document.getElementById("total-emotions"), 15427);
      animateCounter(document.getElementById("positive-emotions"), 67);
      animateCounter(document.getElementById("active-users"), 1243);
      animateCounter(document.getElementById("districts"), 89);
    });
}

// –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ –∏–ª–∏ —Å—Ä–∞–∑—É
window.addEventListener("scroll", loadStatsIfNeeded);
window.addEventListener("DOMContentLoaded", loadStatsIfNeeded);

    fetch(`${SERVER_URL}/api/markers`)
      .then(res => res.ok ? res.json() : [])
      .then(markers => {
        const emoji = { happy: 'üéâ', calm: 'üòä', neutral: 'üòê', sad: 'üò¢', angry: 'üò†' };
        const names = { happy: '–†–∞–¥–æ—Å—Ç—å', calm: '–°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ', neutral: '–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ', sad: '–ì—Ä—É—Å—Ç—å', angry: '–†–∞–∑–¥—Ä–∞–∂–µ–Ω–∏–µ' };

        markers.forEach(m => {
          const icon = L.divIcon({
            html: `<div class="emotion-marker marker-${m.emotion}">${emoji[m.emotion]}</div>`,
            iconSize: [40, 40],
            iconAnchor: [20, 20]
          });
          const popup = `<b>${names[m.emotion]}</b>${m.comment ? `<br><i>${m.comment}</i>` : ''}`;
          L.marker([m.lat, m.lng], { icon }).addTo(map).bindPopup(popup);
        });
      });
  }
  // –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è Firefox –∏ Safari
  if (!window.location.origin) {
    window.location.origin = window.location.protocol + "//" + window.location.host;
  }

  document.addEventListener('DOMContentLoaded', initReadOnlyMap);

</script>
  </body>
</html>


